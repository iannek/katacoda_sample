# 演習概要
- 演習内容
  - 指定回数繰り返しループを行うシェルスクリプトを作成して実行する。
  - 無限ループの処理を行うシェルスクリプトを作成して実行する。(停止は手動で行う)
  - 特定条件が満たされるまで繰り返しループを行うシェルスクリプトを作成して実行する。

- 演習目標
  - 以下のコマンドの使い方を理解する。
    - for
    - while
    - break
    - continue

# 演習内容

## 課題1.一定回数ループを繰り返すシェルスクリプトの作成 
以下の内容を持つシェルスクリプトのファイル(test.sh)を作成・実行する。
  - for文を用いて4回ループする処理を作成し、以下に示すようにループごとにターミナル上にループ回数を出力する。  

  ```
  0
  1
  2
  3
  4
  ```

## 課題2.無限ループのシェルスクリプトの作成
以下の内容を持つシェルスクリプトのファイル(test2.sh)を作成・実行する。停止はターミナル上で`ctrl + c`とキーボードで押して停止する。
  - while文を用いて無限ループを作成し、3秒ごとに"loop"とターミナル上に出力する。

## 課題3.特定条件が満たされるまでループを繰り返すシェルスクリプトの作成
以下の内容を持つシェルスクリプトのファイルを作成・実行する。
 - "hoge.txt"が存在するかを判定する。
   - 判定結果により以下の処理が行われる
     - "hoge.txt"が存在する場合…"OK"とターミナル上に文字を表示して処理を終了する。
     - "hoge.txt"が存在しない場合…"NG"とターミナル上に文字を表示して3秒後に再び同じ判定を行う。
   - ※hoge.txtはシェルスクリプトと同じディレクトリ上に作成する。コマンドの成否だけで判定するためhoge.txtの中身は空で良い。

# ヒント
## 課題1
<details><summary>講義資料参考ページ</summary><div>

- 繰り返しループの書き方
  - p84
</div></details>

## 課題2
<details><summary>講義資料参考ページ</summary><div>

- 繰り返しループの書き方
  - p85
</div></details>

## 課題3
<details><summary>講義資料参考ページ</summary><div>

- 条件指定
  - p82

- 繰り返しループの書き方
  - p85
</div></details>

<details><summary>解くための指針</summary><div>

- 演習2で行った内容と本演習の課題2で行った内容を組み合わせる
- 新しい要素は次の２点
  - `hoge.txt`が存在するかの条件指定
  - 条件が一致したときのループ処理の終了、または一致しないときのループ処理の継続
</div></details>

<details><summary>"hoge.txt"の存在判定の条件指定</summary><div>

- ファイルの存在の判定には、講義資料p82の`-e ファイルパス`(ファイルが存在すれば真)を使用して以下のように記載する。

``` sh
FILE="hoge.txt"

[ -e $FILE ]
```

</div></details>

<details><summary>ループ処理の終了または継続</summary><div>

- 講義資料p85の記載を参照し、ループ処理の終了には`break`、継続には`continue`を使用する。本課題ではどちらも使用する。

</div></details>

# 演習解答  

<details><summary>解答例</summary><div>

## 課題1.一定回数ループを繰り返すシェルスクリプトの作成　解答例  
シェルスクリプトファイル"test.sh"をエディタから作成し、下記の内容を書き込む。  

``` sh
#!/bin/bash

for ((i=0; i<5; i++))
do
  echo $i
done
```

<details><summary>課題1のシェルスクリプトの内容解説</summary><div>

- `for  ((i=0; i<5; i++)) do 処理 done`
  - 繰り返しループ(講義資料p84を参照)
    - forの後で繰り返し回数を制御し、`do`と`done`の間に繰り返し行う処理の内容を記載する。
    - `((i=0; i<5; i++))`　… `繰り返し変数の初期値；繰り返し終了条件; 繰り返し時の変数処理`を表しており、この場合繰り返し変数の初期値はi=0、`do done`の処理が一回終わるごとに変数iの現在の値に1足された後にまた`do done`の処理を行うということを繰り返す。そして、iが5を超えた時点で繰り返し処理が終了となる。
</div></details>


test.shを実行する。  

```
$ bash test.sh
```

以下の内容がターミナル上に表示されていることを確認。  

```
0
1
2
3
4
```

## 課題2.無限ループのシェルスクリプトの作成　解答例  

シェルスクリプトファイル"test2.sh"をエディタから作成し、下記の内容を書き込む。  

``` sh
#!/bin/bash

while true
do
  echo "loop"
  sleep 3
done
```

<details><summary>課題2のシェルスクリプトの内容解説</summary><div>

- `while true do 処理 done`
  - 繰り返し無限ループ(講義資料p85を参照)
    - `while 条件式`の記載で条件式が真のとき`do 処理 done`内の処理を繰り返し、偽になると繰り返し処理を終了する。このシェルスクリプトでは`while true`となっているため、条件式が常に真となるため、無限ループとなる
  - `sleep 時間`…　指定した時間だけ次のコマンド実行を止める
</div></details>

test2.shを実行する。  

```
$ bash test2.sh
```

以下の内容が3秒ごとにターミナル上に表示されていることを確認。  

```
loop
```

ターミナル上で次のキーを押して、シェルスクリプトを停止する。

`ctrl + c`

## 課題3.特定条件が満たされるまでループを繰り返すシェルスクリプトの作成　解答例

シェルスクリプトファイル"test3.sh"をエディタから作成し、下記の内容を書き込む。  

``` sh
#!/bin/bash

FILE="hoge.txt"

while true
do
  if [ -e $FILE ]; then
    echo "OK"
    break
  else
    echo "NG"
    sleep 3
    continue
  fi
done
```

<details><summary>課題3のシェルスクリプトの内容解説</summary><div>

- `[ -e $FILE ]`　…　条件指定。`-e　ファイル名`でファイルが存在する場合は真となる。講義資料p82参照。
- `break contiune` …　`break`はループを終了する処理。`continue`はループを続ける処理となる。講義資料p82参照。
</div></details>

test3.shを実行する。  

```
$ bash test3.sh
```

hoge.txtが存在しない場合は、以下の内容が3秒ごとにターミナル上に表示されていることを確認。  

```
NG
```

hoge.txtが存在する場合は、以下の内容がターミナル上に表示されループが終了することを確認。

```
OK
```

処理中にhoge.txtを作成した場合は下記のようになりループが終了することを確認。

```
NG
NG ←次の処理が実行される前にファイルhoge.txtを作成
OK
```

</div></details>